---
title: "Dark Matter PRF"
type: docs
tags: [alternating-moduli, low-depth]
categories: [PRFs]
math: true
---


> **Designers**: Dan Boneh, Yuval Ishai, Alain Passelègue, Amit Sahai, and David J. Wu
>
> **Article**: Exploring Crypto Dark Matter: New Simple PRF Candidates and Their Applications, TCC 2018

It is a low-depth, MPC friendly weak PRF which uses a combination of linear operations in two different fields, and can be implemented in depth-2 \(ACC^0\) circuit. The key space is \(K_λ = Z_p^{m×n}​\), the domain \(X_λ = \mathbb{Z}_p^n\)​ and the range \(Y_λ = Z_q\)​ where  \(p\) and \(q\) are primes. Define a nonlinear mapping  \(map_{p,q}\) from \( \{0,1,…p−1 \}^m \) to \(Z_q\)
\[ map_{p,q}​ (y) = ∑_{i=1}^n y_i \text{ mod }  q \]
Then the mod−p/mod−q weak PRF is defined as

\[ F_A(x) = map(Ax) \]

for an input \(x \in Z_p^n\)​ and a key A in \(Z_p^{m×n}\)​.

Here, \( y = Ax \) will be a vector in \(Z_p^m\)​ which is viewed as a vector in \( \{0,1,…p−1 \}^m  \) with integer entries; to which we apply the mapping \(map_{p,q}\)​ to get an output in \(Z_q\).
For efficiency, authors suggest using a circulant matrix as a key. Moreover, the linear mapping\(map_{p,q}\) can be replaced by multiplication by a public matrix G in Z_q^{l×n}​ to get a longer output. The main focus is on the case of mod−2/mod−3 weak PRF for which the authors provide a distributed evaluation protocol. The authors also propose an ‘alternative’ binary weak PRF F from Z_2^n × Z_2^ n to Z_2^n which can be described as
\[ F(k,x) = (⟨k,x⟩ \text{ mod } 2+⟨k,x⟩ \text{ mod } 3)\text{ mod } 2 \]

where both key k and input x are binary vectors of length n.

{{< imgproc parameters Fit "600x300" >}}
Parameters.
{{< /imgproc >}}


## Cryptanalysis

1. **Authors:** Jung Hee Cheon, Wonhee Cho, Jeong Han Kim, Jiseung Kim

    **Title:** Adventures in Crypto Dark Matter: Attacks and Fixes for Weak Pseudorandom Functions, PKC 2021

    Authors propose an attack where the advantage of an alternative Mod-2/Mod-3 weak PRF is 2^{−0.105n} with the size of input space n. Similarly, they provide a heuristic attack for circulant mod−2/mod−3 weak PRF with an advantage 2^{−0.21n}. The attack is based on the conditional probability of certain input vectors given that the outputs are ‘zero’, which deviates from 1/2. They suggest using a circulant key generated by two vectors to prevent this attack.
2. **Authors:** Thomas Johansson, Willi Meier, Vu Nguyen
    
    **Title:** Differential cryptanalysis of Mod-2/Mod-3 constructions of binary weak PRFs, IEEE 2023
    
    Authors propose an improved attack for the alternative weak PRF candidate. Their attack outperforms the attack by Cheon et. al. by achieving complexity of O(2^{0.166n})


## References
1. Some reference
2. Other reference



## Implementation 
1. Source code link


{{< alert title="Note" >}}This is a note.{{< /alert >}}

